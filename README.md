Welcome to the Document Markup Plugin
--------------------------------------
Copyright (c) 2003-2013 John Willinsky
Distributed under the GNU GPL v2. For full terms see the file docs/COPYING.

This README file contains a general description of this module's functionality (also available at http://pkp.sfu.ca/wiki/index.php/XML_Publishing).  All settings required for its functionality are managed on its plugin settings page (after installation).

Requirements: OJS 2.4 or greater, PHP 5.x, PHP CURL, PHP Zlib

See technicalNotes.md for description of interface between this module and the Document Markup Server.


This project implements an OJS plugin for automatically parsing NLM 3 XML from uploaded articles and generating published PDF and HTML versions from that XML.

The plugin contains the following settings fields:

	- CSL Style: this allows you to choose any citation style from https://github.com/citation-style-language/styles (find-as-you-type) for automatically reformatting citations of an uploaded article.

	- Create reviewer version: this allows you to automatically strip out author and affiliation details from parsed articles for blind peer review.

	- Header image: this allows you to upload a header image which is automatically placed at the top of generated HTML/PDF documents.

	- Stylesheets: these allow you to replace the CSS used to display the HTML version of the article with stylesheets of your own design.

When an author, copyeditor or editor uploads a new version of an article in a supported format (Microsoft Word .doc/docx, OpenOffice .odt/.docx, or PDF), this module submits it to our parsing server at http://pkp-udev.lib.sfu.ca. The following files are returned in a archive file (X-Y-Z-AG.tar.gz) which is added to the Supplementary files section.

 	manifest.xml
	document-review.pdf (included for reviewers only; has author details stripped out)
 	document-new.pdf (layout version of PDF)
	document.xml (NLM-XML3/JATS-compliant)
	document.html (web-viewable article)

If the article is being uploaded as a publishing-ready galley, this plugin will extract the XML, HTML and PDF as layout versions when they are ready. There may be a few minutes' delay between uploaded a galley copy and receiving the layout versions from our service.

This process is triggered each time an article is submitted, to enable the bibliographic reference work to be available at early stages of review and during copyedit.


Installation

IF THIS MODULE WAS DISTRIBUTED WITH OJS, PLEASE SKIP THE FOLLOWING PARAGRAPH. Use the OJS plugin manager to install. Provide the plugin as "markup.tar.gz."  It will be installed into /ojs/plugins/generic/.

This plugin uses both gateway and generic plugin functionality.  It is installed within the generic folder; and its settings form only appears under the generic category.   

OJS User Experience

While in the Editing tab of an article submission, a journal editor or section editor can directly access the HTML, PDF, and XML files generated by the Document Markup Plugin. These are contained in a zipfile titled "Document Markup Files" found in the "Supplementary Files" list. To provide a reviewer/proofreader/etc. with the converted document.pdf or document-review.pdf (the latter of which has authorship details stripped out for blind peer review), you should extract this file from this zip archive.

In advance of publishing, it is possible to provide reviewers/proofreaders/etc. with direct links to files, provided that galley versions have been established. To create the galley links, just use the "Upload file to Layout Version" option at the bottom of the Layout section; this will automatically create links to HTML, PDF, and XML versions. These will be accessible to all users with the appropriate permissions, and can be selectively deleted.

When an article is published, the galley links shown in the article's layout area will effectively go live. If you delete any of these links, the corresponding file(s) will be deleted. In this way you can selectively prevent the HTML, PDF, or XML version of an article from being publicly available. This never affects the source files originally uploaded by the author.